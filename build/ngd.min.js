var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdAutoHeight",function(e){return{restrict:"A",link:function(t,n){e(function(){if(n.html()){var e=n[0].scrollHeight;n.css({height:e+"px"})}},100)}}});var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdCode",function(){return{restrict:"A",link:function(e,t){var n=t.html();n=n.replace(/^[\r\n]/,""),n=n.replace(/[\r\n]\s+$/,"");var r=n.match(/^\s+/);if(r){var o=new RegExp("^"+r,"gm");n=n.replace(o,"")}t.html(n)}}});var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdEnter",["$parse","$rootScope",function(e,t){return{restrict:"A",link:function(n,r,o){var i=e(o.ngdEnter);r.on("keypress",function(e){if(13===e.which){var r=function(){i(n,{$event:e})};t.$$phase?n.$evalAsync(r):n.$apply(r)}})}}}]);var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdFixedUnder",["$window",function(e){return{restrict:"A",link:function(t,n,r){var o=document.querySelector(r.ngdFixedUnder);if(!o)throw"ngd-fixed-under, no element found by value";angular.element(e).bind("scroll",function(){var e=o.getBoundingClientRect();parseFloat(e.bottom)<0?n.css({position:"fixed",top:0}):n.css({position:"absolute",top:null})})}}}]);var NGD=NGD||angular.module("ngd",[]);NGD.factory("NgdFlash",function(e){return{push:function(t){e.sessionStorage.ngdFlashMessage=t},pull:function(){var t=e.sessionStorage.ngdFlashMessage;return t&&delete e.sessionStorage.ngdFlashMessage,t}}}),NGD.directive("ngdFlash",function(e){return{restrict:"A",link:function(t,n){var r=e.pull();n.html(r)}}});var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdFormUnsaved",["$window",function(e){return{restrict:"A",require:"form",link:function(t,n,r,o){n.bind("submit",function(){o.onSubmit=!0});var i=e.onbeforeunload,a=function(e){return e.preventDefault(),i&&i(e),!o.onSubmit&&o.$dirty?r.ngdFormUnsaved||"Are You Sure?":void 0};e.onbeforeunload=a}}}]);var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdImageDrop",["$parse",function(e){return{restrict:"A",link:function(t,n,r){var o=e(r.ngdImageDrop);n.bind("dragover",function(e){e.preventDefault(),n.addClass("dragover")}),n.bind("dragleave",function(e){e.preventDefault(),angular.element(document.body).removeClass("dragover")}),n.bind("drop",function(e){e.preventDefault(),n.removeClass("dragover");for(var r=[],i=0;i<e.dataTransfer.files.length;i++)e.dataTransfer.files[i].type.match("image")&&r.push(e.dataTransfer.files[i]);r.length>0&&(t.$emit("ngd-image-dropped",{files:r.length?r:[r]}),t.$apply(o(t)));var a=e.dataTransfer.getData("URL");a.match(/\.(png|gif|jpg)$/)&&(t.$emit("ngd-image-dropped",{url:a}),t.$apply(o(t)))})}}}]);var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdImagePaste",["$parse","$http",function(e){return{restrict:"A",link:function(t,n,r){var o=e(r.ngdImagePaste);n.bind("paste",function(){for(var e=[],n=(event.clipboardData||event.originalEvent.clipboardData).items,r=0;r<n.length;r++)n[r].getAsFile().type.match("image")&&e.push(n[r].getAsFile());e.length>0&&(t.$emit("ngd-image-dropped",{files:e}),t.$apply(o(t)))})}}}]);var NGD=NGD||angular.module("ngd",[]);if(NGD.directive("ngdImagePreview",function(){return{restrict:"A",link:function(e,t,n){t.attr("draggable",!0),t.bind("dragleave",function(e){"IMG"==e.target.tagName&&e.target.parentNode.removeChild(e.target)}),e.$on("ngd-image-dropped",function(e,r){var o=function(e){var t=n.ngdImagePreviewWidth||n.width,r=n.ngdImagePreviewHeight||n.height,o=new Image;return o.src=e,t&&(o.width=t),r&&(o.height=r),o},i=function(e){var n=o(e.target.result),r=t[0].querySelector('img[src="'+e.target.result+'"]');r||t[0].appendChild(n)};if(r.files)for(var a=0;a<r.files.length;a++){var l=r.files[a],d=new FileReader;d.onload=i,d.readAsDataURL(l)}else if(r.url){var c=t[0].querySelector('img[src="'+r.url+'"]');if(!c){var s=o(r.url);t[0].appendChild(s)}}})}}}),"undefined"==typeof Markdown){var scriptEl=document.createElement("script");scriptEl.src="http://cdnjs.cloudflare.com/ajax/libs/pagedown/1.0/Markdown.Converter.js",document.head.appendChild(scriptEl)}var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdMarkdownPreview",function(){return{link:function(e,t,n){var r=new Markdown.Converter;t[0].convert=function(e){e=e||t.html();var n=r.makeHtml(e);t.html(n)},e.markdown?t[0].convert(e.markdown):""!==t.html().trim()&&t[0].convert(t.html()),e.markdownPreviews=e.markdownPreviews||{},n.id&&(e.markdownPreviews[n.id]=t[0]),e.markdownPreview=t[0],e.convertMarkdown=function(e,t){var n=document.querySelector("*[ngd-markdown-preview]#"+e);n.convert(t)}}}});var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdOverlay",["$compile","$window",function(e,t){return{link:function(n,r,o){var i=o.ngdOverlay,a=(o.ngdOverlayStyle,void 0===o.ngdOverlayNocss),l=r[0].querySelector(".ngd-overlay-contents");if(!l){var d="<div class='ngd-overlay-contents'>"+r.html()+"</div>";r.html(d),e(r.contents())(n)}r.css({display:"none",top:0,left:0,zIndex:100,background:a&&"rgba(0,0,0,0.5)"}),n.ngdOverlays=n.ngdOverlays||{},n.ngdOverlays[i]=r,n.ngdOverlay={show:function(e,o){var i=n.ngdOverlays[e],l=void 0!==window.pageXOffset,d="CSS1Compat"===(document.compatMode||""),c=l?window.pageXOffset:d?document.documentElement.scrollLeft:document.body.scrollLeft,s=l?window.pageYOffset:d?document.documentElement.scrollTop:document.body.scrollTop;if("string"==typeof o&&(o=document.querySelector(o)),!o)throw"invalid overlay target given, "+o;document.querySelector("body").appendChild(r[0]);var u,g=o.getBoundingClientRect();if(i){"BODY"==o.tagName?(i.css({position:"fixed",display:"block",top:0,left:0,width:"100%",height:"100%"}),u=t.innerHeight,targetElWidth=t.innerWidth):(i.css({position:"absolute",display:"block",top:s+g.top+"px",left:c+g.left+"px",width:g.width+"px",height:g.height+"px"}),u=g.height,targetElWidth=g.width);var p=i[0].querySelector(".ngd-overlay-contents"),v=a?{background:"#fff",display:"inline-block",position:"absolute",textAlign:"center",minWidth:"300px",minHeight:"100px"}:{};angular.element(p).css(v);var f=p.getBoundingClientRect();angular.extend(v,{top:Math.max((u-f.height)/2,0)+"px",left:Math.max((targetElWidth-f.width)/2,0)+"px"}),angular.element(p).css(v)}},hide:function(e){var t=n.ngdOverlays[e];t&&t.css({position:null,display:"none",width:null,height:null,zindex:null})}}}}}]);var NGD=NGD||angular.module("ngd",[]);NGD.config(function($httpProvider){var httpDelayHandler=function($q,$timeout,$rootScope){return function(promise){return promise.then(function(response){if("string"!=typeof response.data)return response;var matches=response.data.match(/<script(.*?)src=(.*?)ngd-preload-controller(.*?)><\/script>/g);if(!matches)return response;for(var i=0;i<matches.length;i++){var scriptTag=matches[i],url=scriptTag.match(/src=['"]([^'"]+)['"]/)[1],request=new XMLHttpRequest;request.onreadystatechange=function(){var DONE=this.DONE||4;this.readyState===DONE&&(eval(this.responseText),$rootScope.$apply())},request.open("GET",url,!0),request.send(null)}return $timeout(function(){return response},2e3)},function(e){return $q.reject(e)})}};$httpProvider.responseInterceptors.push(httpDelayHandler)});var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdPreloadVar",function(e){return{link:function(t,n,r){if("SCRIPT"!==n[0].tagName)throw"Invalid tag. ngd-scope-var only applies to <script> tag";if(!r.ngdPreloadVar)throw"Invalid value. ngd-scope-var requires a scope variable name";r.src&&e.get(r.src).success(function(e){t[r.ngdPreloadVar]=e,t.$apply()}).error(function(){})}}});var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdScript",function(e){return{restrict:"E",link:function(t,n,r){if(r.src&&r.scopeVar)e.get(r.src).success(function(e){t[r.scopeVar]=e}).error(function(){});else{var o=document.createElement("script");if(o.type="text/javascript",r.src)o=r.src;else{var i=n.text();o.text=i}document.head.appendChild(o)}n.remove()}}});var NGD=NGD||angular.module("ngd",[]);NGD.directive("ngdTree",function(){var e='ul[ngd-tree] ul { margin:0px }\nul[ngd-tree] li { list-style: none; }\nul[ngd-tree] li:not(.on) ul {  display: none; }\nul[ngd-tree] li:before { content: " "; display: inline-block; width: 7%;}\nul[ngd-tree] li > *:not(ul) { display: inline-block; width: 90%; border-bottom: 1px solid #ddd}\nul[ngd-tree] li.has-ul:before { content: "▸"; }\nul[ngd-tree] li.has-ul.on:before { content: "▾"; }\n';return{link:function(t,n){var r=document.querySelector("head style#ngd-tree-css");if(!r){var o=document.querySelector("head"),i=angular.element("<style type='text/css' id='ngd-tree-css'>"+e+"</style>");o.appendChild(i[0])}for(var a=n.find("li"),l=0;l<a.length;l++){var d=a[l];d.querySelector("ul")&&angular.element(d).addClass("has-ul")}n.find("li").on("click",function(e){var t=angular.element(e.target);"LI"==t.prop("tagName")&&t.hasClass("has-ul")&&(angular.element(this).toggleClass("on"),e.stopPropagation())})}}});var NGD=NGD||angular.module("ngd",[]);NGD.isElementIn=function(e,t){e.length&&(e=e[0]),t.length&&(t=t[0]),"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]),"function"==typeof jQuery&&t instanceof jQuery&&(t=t[0]);var n=e.getBoundingClientRect();if(t instanceof Window||"Window"==t.constructor.name)return n.top>=0&&n.left>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth);var r=t.getBoundingClientRect();return n.top>=r.top&&n.left>=r.left&&n.bottom<=r.bottom&&n.right<=r.right},NGD.service("NgdViewport",function(){return{currentId:null,currentEl:null,elements:{},selectorToSpy:null,attrToSpy:"id",selectorToNav:null,attrToNav:"href",classForNav:"active"}}),NGD.directive("ngdViewport",["$window","NgdViewport",function(e,t){return{link:function(n,r,o){if(t.selectorToSpy)throw"Only one ngd-viewport is allowed in a document";t.selectorToSpy=o.ngdViewport||"a[id]";var i=t.selectorToSpy.match(/\[(.*)\]/);t.attrToSpy=i[1];for(var a=r[0].querySelectorAll(t.selectorToSpy),l=0;l<a.length;l++){var d=a[l],c=d.getAttribute(t.attrToSpy);if(!c)throw"requires value in attribute, "+t.selectorToSpy+" in ng-viewport";t.elements[c]||(t.elements[c]=d)}var s="BODY"==r.prop("tagName")?angular.element(e):r;s.bind("scroll",function(){for(var e in t.elements){var r=t.elements[e];if(NGD.isElementIn(r,s)){t.currentEl=r,t.currentId=r.getAttribute(t.attrToSpy),n.$apply();break}}})}}}]),NGD.directive("ngdViewportNav",["NgdViewport",function(e){return{link:function(t,n,r){if(e.selectorToNav)throw"Only one ngd-viewport-nav is allowed in a document";t.NgdViewport=e,e.selectorToNav=r.ngdViewportNav||"a[href]";var o=e.selectorToNav.match(/\[(.*)\]/);if(!o)throw"invalid selector for ngdViewportNav";e.attrToNav=o[1],t.$watch("NgdViewport.currentEl",function(t){if(t)for(var r=n[0].querySelectorAll(e.selectorToNav),o=0;o<r.length;o++){var i=angular.element(r[o]),a=r[o].getAttribute(e.attrToNav),l=t.getAttribute(e.attrToSpy);a.match(new RegExp("#"+l+"$"))?i.addClass(e.classForNav):i.removeClass(e.classForNav)}})}}}]),NGD.directive("ngdViewportNavClass",["NgdViewport",function(e){return{link:function(t,n,r){e.classForNav=r.ngdViewportNavClass}}}]),NGD.directive("ngdViewportEl",["NgdViewport",function(e){return{link:function(t,n,r){var o=""+r.ngdViewportEl==""?r.id:r.ngdViewportEl;e.elements[o]||(e.elements[o]=n[0])}}}]);